<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sprite Animation Online</title>

<style>
body{
    margin:0;
    background:#000;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    height:100vh;
    font-family:Arial;
}

canvas{
    background:#111;
    border:2px solid #333;
    max-width:100%;
}

.controls{
    margin-top:15px;
    display:flex;
    gap:10px;
    flex-wrap:wrap;
    justify-content:center;
}

button{
    padding:10px 15px;
    font-size:16px;
    border:none;
    border-radius:8px;
    background:#444;
    color:white;
}

button:active{
    background:#666;
}
</style>
</head>

<body>

<canvas id="game" width="256" height="256"></canvas>

<div class="controls">
    <button onclick="setAnim('idle')">Parado</button>
    <button onclick="setAnim('walk')">Andando</button>
    <button onclick="setAnim('run')">Correndo</button>
    <button onclick="jump()">Pular</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const spriteImage = new Image();
spriteImage.src = "sprites.png"; // coloque sua sprite aqui

const frameWidth = 64;
const frameHeight = 64;

let currentAnimation = "idle";
let frameX = 0;
let frameTimer = 0;
let frameInterval = 100;

let player = {
    x: 96,
    y: 150,
    vy: 0,
    jumping: false
};

const animations = {
    idle: { row: 0, frames: 10, speed: 120 },
    walk: { row: 1, frames: 11, speed: 90 },
    run:  { row: 2, frames: 10, speed: 60 },
    jump: { row: 3, frames: 9,  speed: 80 }
};

function setAnim(name){
    if(name !== "jump"){
        currentAnimation = name;
    }
}

function jump(){
    if(!player.jumping){
        player.jumping = true;
        player.vy = -12;
        currentAnimation = "jump";
    }
}

function update(deltaTime){

    const anim = animations[currentAnimation];
    frameInterval = anim.speed;

    if(frameTimer > frameInterval){
        frameX++;
        if(frameX >= anim.frames){
            frameX = 0;
            if(currentAnimation === "jump"){
                currentAnimation = "idle";
            }
        }
        frameTimer = 0;
    } else {
        frameTimer += deltaTime;
    }

    // gravidade
    player.y += player.vy;
    player.vy += 0.6;

    if(player.y >= 150){
        player.y = 150;
        player.vy = 0;
        player.jumping = false;
    }
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const anim = animations[currentAnimation];

    ctx.drawImage(
        spriteImage,
        frameX * frameWidth,
        anim.row * frameHeight,
        frameWidth,
        frameHeight,
        player.x,
        player.y,
        frameWidth,
        frameHeight
    );
}

let lastTime = 0;

function animate(timeStamp){
    const deltaTime = timeStamp - lastTime;
    lastTime = timeStamp;

    update(deltaTime);
    draw();
    requestAnimationFrame(animate);
}

spriteImage.onload = function(){
    animate(0);
};

// teclado
window.addEventListener("keydown", e=>{
    if(e.key === "ArrowRight"){
        setAnim("run");
    }
    if(e.key === "ArrowLeft"){
        setAnim("walk");
    }
    if(e.key === " "){
        jump();
    }
});

window.addEventListener("keyup", e=>{
    if(e.key === "ArrowRight" || e.key === "ArrowLeft"){
        setAnim("idle");
    }
});
</script>

</body>
</html>
